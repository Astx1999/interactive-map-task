{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{GoogleMap,Marker,useJsApiLoader,InfoWindow}from'@react-google-maps/api';import{observer}from\"mobx-react-lite\";import ConfirmModal from\"../ConfirmModal/ConfirmModal\";import{RootStoreContext}from\"../../stores/RootStore\";import handleApiPath from\"../../utils/handleApiPath\";import styles from'./GoogleMap.module.scss';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const containerStyle={width:'100%',height:'100vh'};const GoogleMapComponent=observer(()=>{const{listStore:{addItem,setActiveItem,activeItem}}=useContext(RootStoreContext);const[showPopup,setShowPopup]=useState(false);const[popupPosition,setPopupPosition]=useState(null);const[center,setCenter]=useState({lat:51.1657,lng:10.4515});const{isLoaded}=useJsApiLoader({googleMapsApiKey:handleApiPath(\"REACT_APP_GOOGLE_API_KEY\")});console.log(activeItem);useEffect(()=>{// calculating active item location and move map to center\nif(activeItem){const distance=Math.sqrt(Math.pow(center.lat-activeItem.lat,2)+Math.pow(center.lng-activeItem.lng,2));const threshold=5;if(distance>threshold){setCenter(activeItem);}}},[activeItem,center]);const handleMapClick=event=>{setShowPopup(true);setPopupPosition({lat:event.latLng.lat(),lng:event.latLng.lng()});};const handleAddLocation=()=>{const newItem={lat:popupPosition.lat,lng:popupPosition.lng};addItem(newItem);setActiveItem(newItem);handleClosePopup();};const handleClosePopup=()=>{setShowPopup(false);setPopupPosition(null);};return isLoaded?/*#__PURE__*/_jsxs(GoogleMap,{mapContainerClassName:styles.map,mapContainerStyle:containerStyle,center:center,zoom:6,onClick:handleMapClick,children:[popupPosition&&showPopup&&/*#__PURE__*/_jsx(InfoWindow,{position:popupPosition,onCloseClick:handleClosePopup,children:/*#__PURE__*/_jsx(ConfirmModal,{isOpen:popupPosition&&showPopup,question:\"Do you want to add the location to the list?\",handleAddLocation:handleAddLocation,handleClosePopup:handleClosePopup,confirmText:\"Add\",rejectText:\"Cancel\"})}),activeItem&&/*#__PURE__*/_jsx(Marker,{position:activeItem})]}):/*#__PURE__*/_jsx(_Fragment,{});});export default GoogleMapComponent;","map":{"version":3,"names":["React","useContext","useEffect","useState","GoogleMap","Marker","useJsApiLoader","InfoWindow","observer","ConfirmModal","RootStoreContext","handleApiPath","styles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","containerStyle","width","height","GoogleMapComponent","listStore","addItem","setActiveItem","activeItem","showPopup","setShowPopup","popupPosition","setPopupPosition","center","setCenter","lat","lng","isLoaded","googleMapsApiKey","console","log","distance","Math","sqrt","pow","threshold","handleMapClick","event","latLng","handleAddLocation","newItem","handleClosePopup","mapContainerClassName","map","mapContainerStyle","zoom","onClick","children","position","onCloseClick","isOpen","question","confirmText","rejectText"],"sources":["/Users/astghik/WebstormProjects/interactive-map-task/src/components/GoogleMap/GoogleMap.js"],"sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nimport {GoogleMap, Marker, useJsApiLoader, InfoWindow} from '@react-google-maps/api';\nimport {observer} from \"mobx-react-lite\";\nimport ConfirmModal from \"../ConfirmModal/ConfirmModal\";\nimport {RootStoreContext} from \"../../stores/RootStore\";\nimport handleApiPath from \"../../utils/handleApiPath\";\nimport styles from './GoogleMap.module.scss'\n\nconst containerStyle = {\n    width: '100%',\n    height: '100vh',\n};\n\nconst GoogleMapComponent = observer(() => {\n    const {listStore: {addItem, setActiveItem, activeItem}} = useContext(RootStoreContext);\n    const [showPopup, setShowPopup] = useState(false);\n    const [popupPosition, setPopupPosition] = useState(null);\n    const [center, setCenter] = useState({lat: 51.1657, lng: 10.4515});\n    const {isLoaded} = useJsApiLoader({googleMapsApiKey: handleApiPath(\"REACT_APP_GOOGLE_API_KEY\"),});\n\n    console.log(activeItem)\n    useEffect(() => {\n        // calculating active item location and move map to center\n        if (activeItem) {\n            const distance = Math.sqrt(\n                Math.pow(center.lat - activeItem.lat, 2) +\n                Math.pow(center.lng - activeItem.lng, 2)\n            );\n            const threshold = 5;\n\n            if (distance > threshold) {\n                setCenter(activeItem);\n            }\n        }\n    }, [activeItem, center]);\n\n    const handleMapClick = (event) => {\n        setShowPopup(true);\n        setPopupPosition({lat: event.latLng.lat(), lng: event.latLng.lng()});\n    };\n\n    const handleAddLocation = () => {\n        const newItem = {\n            lat: popupPosition.lat,\n            lng: popupPosition.lng\n        };\n\n        addItem(newItem);\n        setActiveItem(newItem);\n        handleClosePopup();\n    };\n\n    const handleClosePopup = () => {\n        setShowPopup(false);\n        setPopupPosition(null);\n    };\n\n    return isLoaded ? (\n        <GoogleMap\n            mapContainerClassName={styles.map}\n            mapContainerStyle={containerStyle}\n            center={center}\n            zoom={6}\n            onClick={handleMapClick}\n        >\n            {popupPosition && showPopup && (\n                <InfoWindow position={popupPosition} onCloseClick={handleClosePopup}>\n                    <ConfirmModal\n                        isOpen={popupPosition && showPopup}\n                        question=\"Do you want to add the location to the list?\"\n                        handleAddLocation={handleAddLocation}\n                        handleClosePopup={handleClosePopup}\n                        confirmText={\"Add\"}\n                        rejectText={\"Cancel\"}\n                    />\n                </InfoWindow>\n            )}\n            {activeItem && <Marker position={activeItem}/>}\n        </GoogleMap>\n    ) : <></>;\n});\n\nexport default GoogleMapComponent;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAGC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CAC5D,OAAQC,SAAS,CAAEC,MAAM,CAAEC,cAAc,CAAEC,UAAU,KAAO,wBAAwB,CACpF,OAAQC,QAAQ,KAAO,iBAAiB,CACxC,MAAO,CAAAC,YAAY,KAAM,8BAA8B,CACvD,OAAQC,gBAAgB,KAAO,wBAAwB,CACvD,MAAO,CAAAC,aAAa,KAAM,2BAA2B,CACrD,MAAO,CAAAC,MAAM,KAAM,yBAAyB,QAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE5C,KAAM,CAAAC,cAAc,CAAG,CACnBC,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,OACZ,CAAC,CAED,KAAM,CAAAC,kBAAkB,CAAGd,QAAQ,CAAC,IAAM,CACtC,KAAM,CAACe,SAAS,CAAE,CAACC,OAAO,CAAEC,aAAa,CAAEC,UAAU,CAAC,CAAC,CAAGzB,UAAU,CAACS,gBAAgB,CAAC,CACtF,KAAM,CAACiB,SAAS,CAAEC,YAAY,CAAC,CAAGzB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAAC0B,aAAa,CAAEC,gBAAgB,CAAC,CAAG3B,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAAC4B,MAAM,CAAEC,SAAS,CAAC,CAAG7B,QAAQ,CAAC,CAAC8B,GAAG,CAAE,OAAO,CAAEC,GAAG,CAAE,OAAO,CAAC,CAAC,CAClE,KAAM,CAACC,QAAQ,CAAC,CAAG7B,cAAc,CAAC,CAAC8B,gBAAgB,CAAEzB,aAAa,CAAC,0BAA0B,CAAE,CAAC,CAAC,CAEjG0B,OAAO,CAACC,GAAG,CAACZ,UAAU,CAAC,CACvBxB,SAAS,CAAC,IAAM,CACZ;AACA,GAAIwB,UAAU,CAAE,CACZ,KAAM,CAAAa,QAAQ,CAAGC,IAAI,CAACC,IAAI,CACtBD,IAAI,CAACE,GAAG,CAACX,MAAM,CAACE,GAAG,CAAGP,UAAU,CAACO,GAAG,CAAE,CAAC,CAAC,CACxCO,IAAI,CAACE,GAAG,CAACX,MAAM,CAACG,GAAG,CAAGR,UAAU,CAACQ,GAAG,CAAE,CAAC,CAC3C,CAAC,CACD,KAAM,CAAAS,SAAS,CAAG,CAAC,CAEnB,GAAIJ,QAAQ,CAAGI,SAAS,CAAE,CACtBX,SAAS,CAACN,UAAU,CAAC,CACzB,CACJ,CACJ,CAAC,CAAE,CAACA,UAAU,CAAEK,MAAM,CAAC,CAAC,CAExB,KAAM,CAAAa,cAAc,CAAIC,KAAK,EAAK,CAC9BjB,YAAY,CAAC,IAAI,CAAC,CAClBE,gBAAgB,CAAC,CAACG,GAAG,CAAEY,KAAK,CAACC,MAAM,CAACb,GAAG,CAAC,CAAC,CAAEC,GAAG,CAAEW,KAAK,CAACC,MAAM,CAACZ,GAAG,CAAC,CAAC,CAAC,CAAC,CACxE,CAAC,CAED,KAAM,CAAAa,iBAAiB,CAAGA,CAAA,GAAM,CAC5B,KAAM,CAAAC,OAAO,CAAG,CACZf,GAAG,CAAEJ,aAAa,CAACI,GAAG,CACtBC,GAAG,CAAEL,aAAa,CAACK,GACvB,CAAC,CAEDV,OAAO,CAACwB,OAAO,CAAC,CAChBvB,aAAa,CAACuB,OAAO,CAAC,CACtBC,gBAAgB,CAAC,CAAC,CACtB,CAAC,CAED,KAAM,CAAAA,gBAAgB,CAAGA,CAAA,GAAM,CAC3BrB,YAAY,CAAC,KAAK,CAAC,CACnBE,gBAAgB,CAAC,IAAI,CAAC,CAC1B,CAAC,CAED,MAAO,CAAAK,QAAQ,cACXnB,KAAA,CAACZ,SAAS,EACN8C,qBAAqB,CAAEtC,MAAM,CAACuC,GAAI,CAClCC,iBAAiB,CAAEjC,cAAe,CAClCY,MAAM,CAAEA,MAAO,CACfsB,IAAI,CAAE,CAAE,CACRC,OAAO,CAAEV,cAAe,CAAAW,QAAA,EAEvB1B,aAAa,EAAIF,SAAS,eACvBb,IAAA,CAACP,UAAU,EAACiD,QAAQ,CAAE3B,aAAc,CAAC4B,YAAY,CAAER,gBAAiB,CAAAM,QAAA,cAChEzC,IAAA,CAACL,YAAY,EACTiD,MAAM,CAAE7B,aAAa,EAAIF,SAAU,CACnCgC,QAAQ,CAAC,8CAA8C,CACvDZ,iBAAiB,CAAEA,iBAAkB,CACrCE,gBAAgB,CAAEA,gBAAiB,CACnCW,WAAW,CAAE,KAAM,CACnBC,UAAU,CAAE,QAAS,CACxB,CAAC,CACM,CACf,CACAnC,UAAU,eAAIZ,IAAA,CAACT,MAAM,EAACmD,QAAQ,CAAE9B,UAAW,CAAC,CAAC,EACvC,CAAC,cACZZ,IAAA,CAAAI,SAAA,GAAI,CAAC,CACb,CAAC,CAAC,CAEF,cAAe,CAAAI,kBAAkB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}